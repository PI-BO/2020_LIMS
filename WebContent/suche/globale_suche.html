<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>Insert title here</title>
<style>
	select{
		width: 100%;
	}
</style>
</head>
<body>

	<div id="such_parameter_container">
		<table id="such_parameter_table">
			<tr>
				<th>
					<select id="select_main_category" onChange="GlobaleSuche.createParameters(this);">
						<option value="Projektpartner">Projektpartner</option>
						<option value="Projekt">Projekt</option>
						<option value="Probe">Probe</option>
						<option value="Experiment">Experiment</option>
						<option value="Methode">Methode</option>
					</select>
				</th>
				<th>
				</th>
				<th style="font-weight: normal">Filter hinzufuegen</th>
				<th>
					<input type="button" value="+" onclick="GlobaleSuche.addSuchParameter()" id="globale_suche_add_parameter_button">
				</th>
				<th>
					<input type="button" value="suchen" onclick="GlobaleSuche.search()" id="globale_suche_add_parameter_button">
				</th>
			</tr>
		</table>
	</div>

	<div id="such_liste_ergebnisse">Ergebnisse</div>

	<!-- HIDDEN TEMPLATE  -->

	<div id="such_parameter_row_template" style="display: none;">
		<select class="such_parameter">
			<option value="Name">Name</option>
			<option>ID</option>
		</select> <select>
			<option>entspricht</option>
			<option>beinhaltet</option>
		</select>
		<input type="text" />
		<input type="button" value="-" onclick="GlobaleSuche.deleteSuchParameter(this)" id="globale_suche_add_parameter_button" />
	</div>

	<!-- END TEMPLATE -->

</body>
<script>

	window.onload = function(){
		init();
	}

	function init(){
		
		document.getElementById("globale_suche_add_parameter_button").click();
	}

	class GlobaleSuche{
		
		static search(){
			
			const partner1 = {
					"name" : "Partner A",
					"ansprechpartner" : "Max Mustermann"
			}
			
			const partner2 = {
					"name" : "Partner B",
					"ansprechpartner" : "Jane Doe"
			}
			
			const projekt1 = {
					"id" : "123",
					"name" : "Projekt 1",
					"projektpartner" : "Partner A"
			}
			
			let bla = {
				    "projektpartner" : ["name", "ansprechpartner"],
				    "projekt" : ["id", "name", "projektpartner"],
				    "probe" : ["vergabenummer", "projekt", "wirkstoff", "probennummer", "summenformel"],
				    "experiment" : ["Nr", "Screening No", "Substanz", "API"],
				    "methode" : ["id", "operator"]
				  }
			
			 let bla = {
					    "projektpartner" : [
					    	"Partner A" : {
					    		"name" : 
					    	} 
					    ],
					    "projekt" : ["id", "datum"],
					    "experiment" : ["Nr", "Screening No", "Substanz", "API"],
					    "probe" : ["vergabenummer", "auftraggeber", "wirkstoff", "probennummer", "summenformel"],
					    "methode" : ["id", "operator"]
					  }
			
			let searchCategory = document.getElementById("select_main_category").value;
			
		}


		static addSuchParameter() {
			
			let container = document.getElementById("such_parameter_table");
			
			let template = document.getElementById("such_parameter_row_template");
			
			let childNodes = template.children;
			
			const containerChildrenCount = container.children.length;
			const templateChildrenCount = childNodes.length;
			
			let row = container.insertRow(-1);
			
			for(let i = 0; i < childNodes.length; i++){
				
				let cell = row.insertCell(i);
				var child = childNodes[i].cloneNode(true);
				cell.append(child);
			}
		}
		
		static deleteSuchParameter(suchParameterElement) {
			
			let parent = suchParameterElement.parentElement.parentElement;
			parent.remove();
			let container = document.getElementById("test");
		}
		
		static resetSelects(element){
			
			let allSelects = element.querySelectorAll("select");
			allSelects.forEach(element => {
				console.log(element.options);
				element.options[0].selected="true";
			})
		}
		
		static createParameters(event){
			
		 	let selectElements = findSelectElements(event, "such_parameter");
		 	removeOptions(selectElements);
		 	let options = getOptions(event.value); 
		 	insertOptions(options, selectElements);
		 	
		 	function insertOptions(options, selectElements){
		 		
		 		Array.from(selectElements).forEach(element => {
		 			
			 		options.forEach(parameter => {
				 		let option = document.createElement("option");
				 		option.text = parameter;
				 		option.value = parameter;
				 		element.add(option);
			 		});
		 		})
		 		
		 	}
		 	
		 	function findSelectElements(event, className){
		 		
		 		let table = document.getElementById("such_parameter_table");
		 		let selectElements = document.getElementsByClassName(className);
		 		console.log(selectElements);
		 		return selectElements;
		 	}
		 	
			function removeOptions(selectElements){
				
				Array.from(selectElements).forEach(element => {
					console.log(element);
					let selectOptions = element.querySelectorAll("option");
					selectOptions.forEach(option => option.remove());
				})
				
			}
			
			function getOptions(name){
				  let bla = {
				    "projektpartner" : ["name", "ansprechpartner"],
				    "projekt" : ["id", "datum"],
				    "experiment" : ["Nr", "Screening No", "Substanz", "API"],
				    "probe" : ["vergabenummer", "auftraggeber", "wirkstoff", "probennummer", "summenformel"],
				    "methode" : ["id", "operator"]
				  }
				  return bla[name.toLowerCase()];
				}
		}
	}

</script>
</html>